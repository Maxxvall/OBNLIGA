# audit/code-audit-0042

**–î–∞—Ç–∞:** 2025-10-16  
**–ó–∞–¥–∞—á–∞:** –ü—Ä–∏–≤–µ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ –ø–æ–ª–∏—Ç–∏–∫–µ –∏–∑ docs/cache.md: match-window helper, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π TTL, SWR+SETNX, pre-warm –∏ –æ—Ç–∫–∞–∑ –æ—Ç Redis pub/sub  
**–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:** GitHub Copilot

## 1. –ü–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- "MultiLevelCache"
- "PUBLIC_LEAGUE_SCHEDULE_TTL_SECONDS"
- "If-None-Match"
- "matchWindow"
- "SETNX|lock|swr|stale"

## 2. –ü—Ä–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—É—Ç–∏
- backend/src/cache/
- backend/src/routes/leagueRoutes.ts
- backend/src/services/leagueSchedule.ts
- backend/src/services/matchAggregation.ts
- frontend/src/store/appStore.ts

## 3. –ù–∞–π–¥–µ–Ω–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã
- `backend/src/cache/multilevelCache.ts` ‚Äî in-memory + Redis LRU –±–µ–∑ TTL –∏ —Å pub/sub
- `backend/src/routes/leagueRoutes.ts` ‚Äî —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ TTL –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã/—Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è/—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤/—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- `backend/src/services/leagueSchedule.ts` –∏ `matchAggregation.ts` ‚Äî —Ä—É—á–Ω—ã–µ `defaultCache.set` —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º TTL
- `frontend/src/store/appStore.ts` ‚Äî –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `If-None-Match`, –Ω–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç ETag/TTL —Å–µ—Ä–≤–µ—Ä–∞
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è match-window helper, adaptive TTL –∏ pre-warm, –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç SWR/SETNX

## 4. –†–µ—à–µ–Ω–∏–µ
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å match-window helper, –∫–æ—Ç–æ—Ä—ã–π –≤—ã—á–∏—Å–ª—è–µ—Ç –æ–∫–Ω–∞ –º–∞—Ç—á–µ–π, –∫–µ—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ Redis/–ø–∞–º—è—Ç–∏ –∏ –æ—Ç–¥–∞—ë—Ç —Å—Ç–∞—Ç—É—Å—ã/TTL. –†–∞—Å—à–∏—Ä–∏—Ç—å `MultiLevelCache` –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —ç–∫—Å–ø–∏—Ä–∞—Ü–∏–∏, SWR –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ Redis `SET key value NX EX 30` (—Å –ª–æ–∫–∞–ª—å–Ω—ã–º —Ä–µ–∑–µ—Ä–≤–æ–º), —É–±—Ä–∞—Ç—å pub/sub. –û–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –∏ —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö TTL –∏ –Ω–æ–≤–æ–π –ª–æ–≥–∏–∫–∏ pre-warm, –¥–æ–±–∞–≤–∏—Ç—å HTTP endpoint/–≤–æ—Ä–∫–µ—Ä –¥–ª—è –ø—Ä–æ–≥—Ä–µ–≤–∞. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ –ø–ª–∞–Ω –∏–∑–º–µ–Ω–µ–Ω–∏–π.

## 5. –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å match-window helper + —Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–∫–Ω–∞ –≤ Redis —Å –∫–æ—Ä–æ—Ç–∫–∏–º TTL
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `MultiLevelCache`: TTL –≤ –ø–∞–º—è—Ç–∏, SWR, SETNX-lock, –±–µ–∑ pub/sub, –æ–ø—Ü–∏–∏ `staleWhileRevalidate`
- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å adaptive TTL –≤ –º–∞—Ä—à—Ä—É—Ç—ã –ª–∏–≥–∏ –∏ —Å–µ—Ä–≤–∏—Å—ã, –∑–∞–º–µ–Ω–∏—Ç—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ TTL
- [ ] –î–æ–±–∞–≤–∏—Ç—å pre-warm (endpoint/—É—Ç–∏–ª–∏—Ç—É) –∏ —Å–≤—è–∑–∞—Ç—å —Å helper
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ `audit/changes/0039-*.md`, –æ–ø–∏—Å–∞—Ç—å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
- [ ] –ü—Ä–æ–≥–Ω–∞—Ç—å `npm run lint`/`build` –¥–ª—è backend –∏ –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–ª–∞–Ω

## 6. –ú–µ—Ç—Ä–∏—á–µ—Å–∫–æ–µ –≤–ª–∏—è–Ω–∏–µ
üîµ ‚Äî –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π TTL –∏ SWR —Å–Ω–∏–∂–∞—é—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –ë–î/Redis –ø–æ–¥ –ø–∏–∫–æ–≤—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ —É–º–µ–Ω—å—à–∞—é—Ç –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –∑–∞ —Å—á—ë—Ç 304/—Å—Ç–µ–π–ª–∞.
