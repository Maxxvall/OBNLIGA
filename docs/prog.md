# –ê–Ω–∞–ª–∏–∑ —ç–∫—Å–ø—Ä–µ—Å—Å-–ø—Ä–æ–≥–Ω–æ–∑–æ–≤

## –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

**–≠–∫—Å–ø—Ä–µ—Å—Å** ‚Äî —ç—Ç–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏–π –∏–∑ —Ä–∞–∑–Ω—ã—Ö –º–∞—Ç—á–µ–π –∏ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∏—Ö –≤ –æ–¥–∏–Ω –ø—Ä–æ–≥–Ω–æ–∑. –û—á–∫–∏ –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –í–°–ï —Å–æ–±—ã—Ç–∏—è –≤ —ç–∫—Å–ø—Ä–µ—Å—Å–µ —É–≥–∞–¥–∞–Ω—ã.

### –ü—Ä–∏–º–µ—Ä
- –ú–∞—Ç—á 1: –ö–∏–±–æ—Ä–≥–∏ vs –ö—Ä–µ–∞—Ç–∏–≤ ‚Üí –ü1 (–ø–æ–±–µ–¥–∞ –ö–∏–±–æ—Ä–≥–æ–≤)
- –ú–∞—Ç—á 2: –î–æ–∂–¥—å vs –ü–æ–ª—ë—Ç ‚Üí –¢–ë 3.5 (—Ç–æ—Ç–∞–ª –±–æ–ª—å—à–µ 3.5)
- –ú–∞—Ç—á 3: –°—Ç–∞—Ä—Ç vs –î–∏–Ω–∞–º–æ ‚Üí –ù–µ—Ç –ø–µ–Ω–∞–ª—å—Ç–∏

–ï—Å–ª–∏ –≤—Å–µ —Ç—Ä–∏ —É–≥–∞–¥–∞–Ω—ã ‚Üí —ç–∫—Å–ø—Ä–µ—Å—Å –≤—ã–∏–≥—Ä—ã–≤–∞–µ—Ç –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —É–º–Ω–æ–∂–µ–Ω–Ω—ã–µ –æ—á–∫–∏.

---

## –õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á—ë—Ç–∞ –æ—á–∫–æ–≤

### –ë–∞–∑–æ–≤–∞—è —Ñ–æ—Ä–º—É–ª–∞
```
–û—á–∫–∏ —ç–∫—Å–ø—Ä–µ—Å—Å–∞ = —Å—É–º–º–∞_–±–∞–∑–æ–≤—ã—Ö_–æ—á–∫–æ–≤ √ó –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç_—ç–∫—Å–ø—Ä–µ—Å—Å–∞
```

### –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —É–º–Ω–æ–∂–µ–Ω–∏—è
| –ö–æ–ª-–≤–æ —Å–æ–±—ã—Ç–∏–π | –ú–Ω–æ–∂–∏—Ç–µ–ª—å | –†–∏—Å–∫ |
|---------------|-----------|------|
| 2 —Å–æ–±—ã—Ç–∏—è | √ó1.2 | –ù–∏–∑–∫–∏–π |
| 3 —Å–æ–±—ã—Ç–∏—è | √ó1.5 | –°—Ä–µ–¥–Ω–∏–π |
| 4 —Å–æ–±—ã—Ç–∏—è | √ó2.5 | –í—ã—Å–æ–∫–∏–π |

### –ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á—ë—Ç–∞
- –°–æ–±—ã—Ç–∏–µ 1: –ü1 = 5 –æ—á–∫–æ–≤
- –°–æ–±—ã—Ç–∏–µ 2: –¢–ë 3.5 = 7 –æ—á–∫–æ–≤  
- –°–æ–±—ã—Ç–∏–µ 3: –ü–µ–Ω–∞–ª—å—Ç–∏ –ù–µ—Ç = 10 –æ—á–∫–æ–≤

**–ï—Å–ª–∏ –≤—Å–µ —É–≥–∞–¥–∞–Ω—ã:**
- –°—É–º–º–∞: 5 + 7 + 10 = 22 –æ—á–∫–∞
- –° –º–Ω–æ–∂–∏—Ç–µ–ª–µ–º √ó1.5 = **33 –æ—á–∫–∞**

**–ï—Å–ª–∏ —Ö–æ—Ç—å –æ–¥–Ω–æ –Ω–µ —É–≥–∞–¥–∞–Ω–æ:**
- –û—á–∫–æ–≤: **0**

---

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–ú–∞–∫—Å–∏–º—É–º 2 —ç–∫—Å–ø—Ä–µ—Å—Å–∞ –∑–∞ 6 –¥–Ω–µ–π –∫–∞–∫ –∏ –ª–æ–≥–∏–∫–∞ —É 10 –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –∑–∞ 6 –¥–Ω–µ–π —É–∂–µ –µ—Å—Ç—å**
2. **–ú–∏–Ω–∏–º—É–º 2 —Å–æ–±—ã—Ç–∏—è** –≤ —ç–∫—Å–ø—Ä–µ—Å—Å–µ
3. **–ú–∞–∫—Å–∏–º—É–º 4 —Å–æ–±—ã—Ç–∏—è** –≤ —ç–∫—Å–ø—Ä–µ—Å—Å–µ
4. **–ö–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –∏–∑ —Ä–∞–∑–Ω–æ–≥–æ –º–∞—Ç—á–∞** (–Ω–µ–ª—å–∑—è 2 —Å–æ–±—ã—Ç–∏—è –∏–∑ –æ–¥–Ω–æ–≥–æ –º–∞—Ç—á–∞)
5. **–¢–æ–ª—å–∫–æ PENDING –º–∞—Ç—á–∏** (–Ω–µ–ª—å–∑—è –¥–æ–±–∞–≤–∏—Ç—å –º–∞—Ç—á –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ –Ω–∞—á–∞–ª—Å—è)

---

## –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã

```prisma
model ExpressBet {
  id          BigInt        @id @default(autoincrement()) @map("express_bet_id")
  userId      Int           @map("user_id")
  status      ExpressStatus @default(PENDING)
  multiplier  Decimal       @default(1.0) @map("multiplier")
  basePoints  Int           @map("base_points")
  scoreAwarded Int?         @map("score_awarded")
  createdAt   DateTime      @default(now()) @map("created_at")
  resolvedAt  DateTime?     @map("resolved_at")
  
  items       ExpressBetItem[]
  appUser     AppUser       @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId, status], map: "express_bet_user_status_idx")
  @@index([status, createdAt], map: "express_bet_status_created_idx")
  @@map("express_bet")
}

model ExpressBetItem {
  id          BigInt          @id @default(autoincrement()) @map("express_bet_item_id")
  expressId   BigInt          @map("express_id")
  templateId  BigInt          @map("template_id")
  selection   String
  status      PredictionEntryStatus @default(PENDING)
  basePoints  Int             @map("base_points")
  resolvedAt  DateTime?       @map("resolved_at")
  
  express     ExpressBet      @relation(fields: [expressId], references: [id], onDelete: Cascade)
  template    PredictionTemplate @relation(fields: [templateId], references: [id], onDelete: Cascade)

  @@unique([expressId, templateId], map: "express_item_unique")
  @@index([expressId], map: "express_item_express_idx")
  @@map("express_bet_item")
}

enum ExpressStatus {
  PENDING     // –û–∂–∏–¥–∞–µ—Ç —Ä–∞—Å—á—ë—Ç–∞
  WON         // –í—Å–µ —Å–æ–±—ã—Ç–∏—è —É–≥–∞–¥–∞–Ω—ã
  LOST        // –•–æ—Ç—è –±—ã –æ–¥–Ω–æ –Ω–µ —É–≥–∞–¥–∞–Ω–æ
  CANCELLED   // –û—Ç–º–µ–Ω—ë–Ω (–º–∞—Ç—á –æ—Ç–º–µ–Ω—ë–Ω)
  VOID        // –ê–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω
}
```

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö

```prisma
model AppUser {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
  expressBets ExpressBet[]
}

model PredictionTemplate {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
  expressItems ExpressBetItem[]
}
```

---

## –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–∏—Å—Ç–µ–º—É

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (PostgreSQL)
| –û–ø–µ—Ä–∞—Ü–∏—è | –ß–∞—Å—Ç–æ—Ç–∞ | –ù–∞–≥—Ä—É–∑–∫–∞ |
|----------|---------|----------|
| –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫—Å–ø—Ä–µ—Å—Å–∞ | ~50/–Ω–µ–¥–µ–ª—è | –ù–∏–∑–∫–∞—è |
| –ß—Ç–µ–Ω–∏–µ —ç–∫—Å–ø—Ä–µ—Å—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | ~200/–¥–µ–Ω—å | –ù–∏–∑–∫–∞—è |
| –†–∞—Å—á—ë—Ç —ç–∫—Å–ø—Ä–µ—Å—Å–∞ | ~50/–Ω–µ–¥–µ–ª—è | –°—Ä–µ–¥–Ω—è—è |

**–ò—Ç–æ–≥–æ:** –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –ë–î ~**5-10%** –ø—Ä–∏ —Ç–µ–∫—É—â–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

### Redis
| –û–ø–µ—Ä–∞—Ü–∏—è | –ß–∞—Å—Ç–æ—Ç–∞ | TTL |
|----------|---------|-----|
| –°—á—ë—Ç—á–∏–∫ —ç–∫—Å–ø—Ä–µ—Å—Å–æ–≤ –∑–∞ –Ω–µ–¥–µ–ª—é | ~200/–¥–µ–Ω—å | 7 –¥–Ω–µ–π |
| –ö—ç—à —ç–∫—Å–ø—Ä–µ—Å—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | ~200/–¥–µ–Ω—å | 5 –º–∏–Ω—É—Ç |

**–ò—Ç–æ–≥–æ:** ~**2-3%** –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ Redis.

### –°–µ—Ä–≤–µ—Ä (Node.js)
- –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫—Å–ø—Ä–µ—Å—Å–∞: O(n) –≥–¥–µ n ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π (2-4)
- –†–∞—Å—á—ë—Ç —ç–∫—Å–ø—Ä–µ—Å—Å–∞: –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ —Ä–∞—Å—á—ë—Ç–µ –º–∞—Ç—á–∞, O(m) –≥–¥–µ m ‚Äî —ç–∫—Å–ø—Ä–µ—Å—Å—ã —Å —ç—Ç–∏–º –º–∞—Ç—á–µ–º

**–ò—Ç–æ–≥–æ:** –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ CPU.

---

## API Endpoints

### POST /api/predictions/express
–°–æ–∑–¥–∞–Ω–∏–µ —ç–∫—Å–ø—Ä–µ—Å—Å–∞
```json
{
  "items": [
    { "templateId": 123, "selection": "ONE" },
    { "templateId": 456, "selection": "OVER_3.5" },
    { "templateId": 789, "selection": "NO" }
  ]
}
```

### GET /api/predictions/express/my
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–≤–æ–∏—Ö —ç–∫—Å–ø—Ä–µ—Å—Å–æ–≤

### GET /api/predictions/express/week-count
–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ —ç–∫—Å–ø—Ä–µ—Å—Å–æ–≤ –∑–∞ –Ω–µ–¥–µ–ª—é

---

## –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞—Å—á—ë—Ç–∞

1. –ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –º–∞—Ç—á–∞ —Ä–∞—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤—Å–µ PredictionEntry —Å —ç—Ç–∏–º –º–∞—Ç—á–µ–º
2. –ù–∞—Ö–æ–¥—è—Ç—Å—è –≤—Å–µ ExpressBetItem —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —à–∞–±–ª–æ–Ω–∞–º–∏ —ç—Ç–æ–≥–æ –º–∞—Ç—á–∞
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ ExpressBetItem –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å (WON/LOST)
4. –ï—Å–ª–∏ –≤—Å–µ items –≤ —ç–∫—Å–ø—Ä–µ—Å—Å–µ —Ä–∞—Å—á–∏—Ç–∞–Ω—ã:
   - –ï—Å–ª–∏ –≤—Å–µ WON ‚Üí ExpressBet.status = WON, –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è –æ—á–∫–∏
   - –ï—Å–ª–∏ —Ö–æ—Ç—å –æ–¥–∏–Ω LOST ‚Üí ExpressBet.status = LOST

---

## –û—Ü–µ–Ω–∫–∞ –∏–¥–µ–∏

### –ö–∞—á–µ—Å—Ç–≤–æ –∏–¥–µ–∏: **85/100** ‚úÖ

**–ü–ª—é—Å—ã:**
- ‚úÖ –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç engagement –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –î–æ–±–∞–≤–ª—è–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫—É—é –≥–ª—É–±–∏–Ω—É
- ‚úÖ –ü–æ–≤—ã—à–∞–µ—Ç —Ä–∏—Å–∫ ‚Üí –≤—ã—à–µ –Ω–∞–≥—Ä–∞–¥–∞ (–≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è)
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 2 –∑–∞ 6 –¥–Ω–µ–π —Å–æ–∑–¥–∞—ë—Ç —Ü–µ–Ω–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–∞

### –°–ª–æ–∂–Ω–æ—Å—Ç—å –≤–Ω–µ–¥—Ä–µ–Ω–∏—è: **65/100** (—Å—Ä–µ–¥–Ω—è—è)

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –í—Ä–µ–º—è |
|-----------|-----------|-------|
| Prisma –º–∏–≥—Ä–∞—Ü–∏—è | –ù–∏–∑–∫–∞—è | 1—á |
| Backend API | –°—Ä–µ–¥–Ω—è—è | 4—á |
| –õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á—ë—Ç–∞ | –°—Ä–µ–¥–Ω—è—è | 3—á |
| Frontend UI | –í—ã—Å–æ–∫–∞—è | 6—á |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | –°—Ä–µ–¥–Ω—è—è | 4—á |
| **–ò—Ç–æ–≥–æ** | ‚Äî | **~18—á** |

---

### –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä/–ë–î/Redis: **15/100** (–Ω–∏–∑–∫–∞—è) ‚úÖ

–ü—Ä–∏ —Ç–µ–∫—É—â–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (~100-200 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π) –Ω–∞–≥—Ä—É–∑–∫–∞ –±—É–¥–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π:
- PostgreSQL: +5-10% –∑–∞–ø—Ä–æ—Å–æ–≤
- Redis: +2-3% –æ–ø–µ—Ä–∞—Ü–∏–π
- CPU: –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–†–µ–∫–æ–º–µ–Ω–¥—É—é –≤–Ω–µ–¥—Ä—è—Ç—å** üëç

–§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–∏—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω—É—é –º–µ—Ö–∞–Ω–∏–∫—É –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∑–∏—Ç —Å–∏—Å—Ç–µ–º—É –∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç ~2-3 –¥–Ω—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

### –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

1. **–§–∞–∑–∞ 1** ‚Äî Backend
   - –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î
   - API endpoints
   - –õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á—ë—Ç–∞

2. **–§–∞–∑–∞ 2** ‚Äî Frontend  
   - –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–æ–∑–¥–∞–Ω–∏—è —ç–∫—Å–ø—Ä–µ—Å—Å–∞
   - –°–ø–∏—Å–æ–∫ —ç–∫—Å–ø—Ä–µ—Å—Å–æ–≤ –≤ "–ú–æ–∏ –ø—Ä–æ–≥–Ω–æ–∑—ã"
   - –ê–Ω–∏–º–∞—Ü–∏—è –≤—ã–∏–≥—Ä—ã—à–∞/–ø—Ä–æ–∏–≥—Ä—ã—à–∞

3. **–§–∞–∑–∞ 3** ‚Äî –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
   - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Redis
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞–≥—Ä—É–∑–∫–∏

