# 0035 — Telegram init-data миграция и безопасные рассылки

## Что изменилось
- Перешли на официальный стек `@tma.js/*` в бэкенд-обработчике `/api/auth/telegram-init`, обновив валидацию и парсинг initData.
- Переписали `newsWorker` на использование клиента `grammy`, убрав зависимость `node-telegram-bot-api` и связанные уязвимости.
- Сгенерировали `package-lock.json` для корня, backend, admin и frontend с обновлёнными зависимостями.
- Перенесли `@types/node` в runtime-зависимости и подключили типы Node.js в `tsconfig`, чтобы бэкенд собирался на Render при `npm ci --omit=dev`.
- Зафиксировали совместимую с Fastify v4 версию `@fastify/cookie` (`^9.3.1`), чтобы production-старт не падал на проверке плагинов.

## Влияние на инфраструктуру
- Убраны transitively уязвимые версии `form-data` и `tough-cookie` (входит через `node-telegram-bot-api`).
- Подготовленные lock-файлы допускают воспроизводимые деплой-сборки на Render (`npm ci --omit=dev`).

## Проверки
- `npm install` (root, backend, admin, frontend)
- Ручной анализ типов: убедились, что новые API `@tma.js` и `grammy` типобезопасны.

## Метрическое влияние
⚪ — Улучшена техническая стабильность и безопасность без изменения пользовательского функционала.
